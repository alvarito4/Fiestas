<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fiesta Ancla2 ðŸŽ‰ðŸ”¥</title>

  <style>
    body { font-family: Arial, sans-serif; background:#1a0033; color:white; margin:0; }
    header { text-align:center; padding:100px 20px; background:#00000080; }
    h1 { font-size:4rem; margin:0; }
    .info { text-align:center; margin:40px auto; font-size:1.3rem; }
    #mapaContainer { width:90%; max-width:800px; height:400px; margin:40px auto; border-radius:20px; overflow:hidden; }
    .countdown { display:flex; justify-content:center; gap:20px; margin-top:30px; }
    .countdown div { background:#ffffff20; padding:20px; border-radius:10px; min-width:100px; }
    .countdown span { font-size:2.5rem; font-weight:bold; display:block; }
  </style>
</head>
<body>

<header>
  <h1>Â¡FIESTA Ã‰PICA!</h1>
  <p>En CervecerÃ­a Ancla2</p>
</header>

<section class="info">
  <p><strong>Fecha:</strong> <span id="fechaTexto"></span></p>
  <p><strong>Hora:</strong> <span id="horaTexto"></span></p>
  <p><strong>UbicaciÃ³n:</strong> <span id="ubicacion"></span></p>
  <p id="descripcion"></p>
</section>

<div class="countdown">
  <div><span id="days">00</span>DÃ­as</div>
  <div><span id="hours">00</span>Horas</div>
  <div><span id="minutes">00</span>Min</div>
  <div><span id="seconds">00</span>Seg</div>
</div>

<div id="mapaContainer"></div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCY9XkCT3EBUtzyjT-WPxZRU32nsLV71HY",
  authDomain: "fiestas-ancla2.firebaseapp.com",
  projectId: "fiestas-ancla2",
  storageBucket: "fiestas-ancla2.firebasestorage.app",
  messagingSenderId: "972175520634",
  appId: "1:972175520634:web:708cd1b614c48c10d45cc3",
  measurementId: "G-G51626F5SE"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let eventDate = null;

// Leer datos en tiempo real
db.collection("evento").doc("datos").onSnapshot((doc) => {
  if (doc.exists) {
    const data = doc.data();

    document.getElementById("fechaTexto").innerText = data.fecha;
    document.getElementById("horaTexto").innerText = data.hora;
    document.getElementById("descripcion").innerText = data.descripcion;
    document.getElementById("ubicacion").innerText = data.ubicacion;

    // Generar mapa automÃ¡ticamente
    const encoded = encodeURIComponent(data.ubicacion);
    document.getElementById("mapaContainer").innerHTML =
      `<iframe width="100%" height="100%" style="border:0;" loading="lazy"
        src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCY9XkCT3EBUtzyjT-WPxZRU32nsLV71HY&q=${encoded}">
      </iframe>`;

    eventDate = new Date(`${data.fecha}T${data.hora}`).getTime();
  }
});

// Cuenta atrÃ¡s
setInterval(() => {
  if (!eventDate) return;

  const now = new Date().getTime();
  const distance = eventDate - now;

  if (distance < 0) return;

  document.getElementById("days").innerText = Math.floor(distance / (1000*60*60*24));
  document.getElementById("hours").innerText = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
  document.getElementById("minutes").innerText = Math.floor((distance%(1000*60*60))/(1000*60));
  document.getElementById("seconds").innerText = Math.floor((distance%(1000*60))/1000);
}, 1000);
</script>

</body>
</html>
